{% extends "base.html" %} {% block title %}ìƒí™©ë³„ ì½˜í…ì¸  ìƒì„± - ì˜¤ëˆ„ì´ í•œêµ­ì–´{%
endblock %} {% block content %}
<div class="max-w-6xl mx-auto px-4 py-8">
  <div class="bg-white rounded-2xl p-6 shadow-lg">
    <!-- Header -->
    <header class="mb-8">
      <div
        class="inline-flex items-center gap-2 px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-semibold mb-2"
      >
        <span class="w-2 h-2 bg-purple-500 rounded-full"></span>
        ONUI Â· AI ì½˜í…ì¸  ìƒì„±
      </div>
      <h1 class="text-3xl font-bold text-gray-900 mb-2">
        ğŸ¨ ìƒí™©ë³„ ì´ë¯¸ì§€ ìƒì„±
      </h1>
      <p class="text-sm text-gray-600">
        í•™ìŠµ ìƒí™©ì— ë§ëŠ” ì´ë¯¸ì§€ë¥¼ AIë¡œ ìë™ ìƒì„±í•©ë‹ˆë‹¤ (DALL-E 3)
      </p>
    </header>

    <!-- Input Section -->
    <section
      class="mb-8 p-6 bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl border border-purple-200"
    >
      <h2
        class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"
      >
        <span class="text-2xl">ğŸ“</span>
        ìƒí™© ì„¤ëª…
      </h2>

      <div class="space-y-4">
        <!-- Situation Input -->
        <div>
          <label
            for="situation"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            í•™ìŠµ ìƒí™©ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”
          </label>
          <textarea
            id="situation"
            rows="4"
            class="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none text-sm"
          >ì„œìš¸ ì‹œì¥ì—ì„œ ê³¼ì¼ì„ ì‚¬ëŠ” ìƒí™©</textarea>
        </div>

        <!-- Options -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label
              for="imageStyle"
              class="block text-sm font-medium text-gray-700 mb-2"
            >
              ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼
            </label>
            <select
              id="imageStyle"
              class="w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm"
            >
              <option value="watercolor" selected>ìˆ˜ì±„í™” (Watercolor)</option>
              <option value="illustration">ì¼ëŸ¬ìŠ¤íŠ¸ (Illustration)</option>
              <option value="cartoon">ë§Œí™” (Cartoon)</option>
              <option value="realistic">ì‚¬ì‹¤ì ì¸ (Realistic)</option>
              <option value="oil-painting">ìœ í™” (Oil Painting)</option>
              <option value="pencil-sketch">ì—°í•„ ìŠ¤ì¼€ì¹˜ (Pencil Sketch)</option>
              <option value="digital-art">ë””ì§€í„¸ ì•„íŠ¸ (Digital Art)</option>
              <option value="anime">ì• ë‹ˆë©”ì´ì…˜ (Anime)</option>
              <option value="vintage">ë¹ˆí‹°ì§€ (Vintage)</option>
              <option value="minimalist">ë¯¸ë‹ˆë©€ë¦¬ìŠ¤íŠ¸ (Minimalist)</option>
              <option value="pop-art">íŒì•„íŠ¸ (Pop Art)</option>
              <option value="3d-render">3D ë Œë”ë§ (3D Render)</option>
            </select>
          </div>

          <div>
            <label
              for="imageQuality"
              class="block text-sm font-medium text-gray-700 mb-2"
            >
              ì´ë¯¸ì§€ í’ˆì§ˆ
            </label>
            <select
              id="imageQuality"
              class="w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm"
            >
              <option value="standard" selected>í‘œì¤€ (Standard)</option>
              <option value="hd">ê³ í™”ì§ˆ (HD)</option>
            </select>
          </div>
        </div>

        <!-- Generate Button -->
        <button
          onclick="generateImage()"
          class="w-full bg-gradient-to-r from-purple-500 to-pink-600 text-white px-6 py-3 rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all shadow-md hover:shadow-lg font-medium"
        >
          ğŸ¨ ì´ë¯¸ì§€ ìƒì„±í•˜ê¸°
        </button>
      </div>
    </section>

    <!-- Results Section -->
    <section id="resultsSection" class="hidden">
      <!-- Image Result -->
      <div
        class="p-6 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-200"
      >
        <h3
          class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"
        >
          <span class="text-2xl">ğŸ–¼ï¸</span>
          ìƒì„±ëœ ì´ë¯¸ì§€
        </h3>
        <div id="imageResult" class="bg-white rounded-lg p-4 shadow-inner">
          <div class="flex items-center justify-center h-64 text-gray-400">
            ì´ë¯¸ì§€ ë¡œë”© ì¤‘...
          </div>
        </div>
        <div class="mt-4 flex gap-2">
          <button
            onclick="downloadImage()"
            class="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition text-sm"
          >
            ğŸ“¥ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
          </button>
          <button
            onclick="regenerateImage()"
            class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition text-sm"
          >
            ğŸ”„ ë‹¤ì‹œ ìƒì„±
          </button>
        </div>
      </div>
    </section>

    <!-- Info Section -->
    <section class="mt-8 p-4 bg-gray-50 rounded-xl border border-gray-200">
      <div class="text-sm font-semibold text-gray-900 mb-2">ğŸ’¡ ì‚¬ìš© ê°€ì´ë“œ</div>
      <div class="text-xs text-gray-700 space-y-1">
        <p>
          â€¢ <strong>ìƒí™© ì„¤ëª…</strong>: í•™ìŠµ ìƒí™©ì„ ìì„¸íˆ ì„¤ëª…í•˜ë©´ ë” ì •í™•í•œ
          ì´ë¯¸ì§€ê°€ ìƒì„±ë©ë‹ˆë‹¤
        </p>
        <p>
          â€¢ <strong>ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼</strong>: ìˆ˜ì±„í™”, ì¼ëŸ¬ìŠ¤íŠ¸, ë§Œí™”, ì‚¬ì‹¤ì ì¸, ìœ í™”, ì—°í•„ ìŠ¤ì¼€ì¹˜, ë””ì§€í„¸ ì•„íŠ¸, ì• ë‹ˆë©”ì´ì…˜, ë¹ˆí‹°ì§€, ë¯¸ë‹ˆë©€ë¦¬ìŠ¤íŠ¸, íŒì•„íŠ¸, 3D ë Œë”ë§ ë“± 12ê°€ì§€ ìŠ¤íƒ€ì¼ ì¤‘ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
        </p>
        <p>
          â€¢ <strong>ì´ë¯¸ì§€ í’ˆì§ˆ</strong>: í‘œì¤€ í’ˆì§ˆ(ë¹ ë¦„) ë˜ëŠ” ê³ í™”ì§ˆ(ëŠë¦¼) ì¤‘
          ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
        </p>
        <p>
          â€¢ <strong>í™œìš© ë°©ë²•</strong>: ìƒì„±ëœ ì´ë¯¸ì§€ëŠ” êµì¬ ì œì‘, ë°œí‘œ ìë£Œ,
          í•™ìŠµ ì¹´ë“œ ë“±ì— í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
        </p>
        <p>
          â€¢ <strong>ì£¼ì˜ì‚¬í•­</strong>: AI ìƒì„± ì´ë¯¸ì§€ëŠ” í•™ìŠµ ëª©ì ìœ¼ë¡œë§Œ
          ì‚¬ìš©í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤
        </p>
      </div>
    </section>
  </div>
</div>

<script>
  let currentImageUrl = null;
  let generationTime = 0;

  async function generateImage() {
    const situation = document.getElementById("situation").value.trim();

    if (!situation) {
      alert("í•™ìŠµ ìƒí™©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }

    const imageStyle = document.getElementById("imageStyle").value;
    const imageQuality = document.getElementById("imageQuality").value;

    // Show results section
    document.getElementById("resultsSection").classList.remove("hidden");

    // Show loading state
    document.getElementById("imageResult").innerHTML =
      '<div class="flex items-center justify-center h-64"><div class="text-center"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto mb-4"></div><p class="text-gray-600">DALL-E 3ë¡œ ì´ë¯¸ì§€ ìƒì„± ì¤‘...</p><p class="text-xs text-gray-500 mt-2">ìµœëŒ€ 30ì´ˆ ì •ë„ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p></div></div>';

    // Start timer
    const startTime = Date.now();

    try {
      // Generate Image
      const imageResponse = await fetch("/api/generate-image", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          situation: situation,
          style: imageStyle,
          quality: imageQuality,
        }),
      });

      const imageData = await imageResponse.json();

      // Calculate generation time
      generationTime = ((Date.now() - startTime) / 1000).toFixed(2);

      if (imageData.success) {
        currentImageUrl = imageData.image_url;
        document.getElementById(
          "imageResult"
        ).innerHTML = `
          <img src="${imageData.image_url}" alt="ìƒì„±ëœ ì´ë¯¸ì§€" class="w-full rounded-lg" />
          <div class="mt-3 text-center">
            <p class="text-xs text-gray-500">â±ï¸ ìƒì„± ì‹œê°„: ${generationTime}ì´ˆ</p>
            <p class="text-xs text-gray-400 mt-1">ìŠ¤íƒ€ì¼: ${getStyleName(imageStyle)} | í’ˆì§ˆ: ${imageQuality === 'hd' ? 'ê³ í™”ì§ˆ' : 'í‘œì¤€'}</p>
          </div>
        `;
      } else {
        document.getElementById(
          "imageResult"
        ).innerHTML = `<div class="text-center text-red-600 py-8">ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨: ${
          imageData.message || "ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"
        }</div>`;
      }
    } catch (error) {
      console.error("ì´ë¯¸ì§€ ìƒì„± ì˜¤ë¥˜:", error);
      document.getElementById(
        "imageResult"
      ).innerHTML = `<div class="text-center text-red-600 py-8">ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</div>`;
    }
  }

  function getStyleName(styleValue) {
    const styleNames = {
      "watercolor": "ìˆ˜ì±„í™”",
      "illustration": "ì¼ëŸ¬ìŠ¤íŠ¸",
      "cartoon": "ë§Œí™”",
      "realistic": "ì‚¬ì‹¤ì ì¸",
      "oil-painting": "ìœ í™”",
      "pencil-sketch": "ì—°í•„ ìŠ¤ì¼€ì¹˜",
      "digital-art": "ë””ì§€í„¸ ì•„íŠ¸",
      "anime": "ì• ë‹ˆë©”ì´ì…˜",
      "vintage": "ë¹ˆí‹°ì§€",
      "minimalist": "ë¯¸ë‹ˆë©€ë¦¬ìŠ¤íŠ¸",
      "pop-art": "íŒì•„íŠ¸",
      "3d-render": "3D ë Œë”ë§"
    };
    return styleNames[styleValue] || styleValue;
  }

  function downloadImage() {
    if (!currentImageUrl) {
      alert("ë‹¤ìš´ë¡œë“œí•  ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.");
      return;
    }
    const link = document.createElement("a");
    link.href = currentImageUrl;
    link.download = "onui-generated-image.png";
    link.click();
  }

  function regenerateImage() {
    generateImage();
  }
</script>
{% endblock %}
